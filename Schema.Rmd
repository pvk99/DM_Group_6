---
title: "Group6_IB9HP0"
output: html_document
date: "2024-02-23"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

rm(list=ls())
library(readr)
library(RSQLite)
library(dplyr)
```
## Creating a connection to a database

```{r connect}
my_db <- RSQLite::dbConnect(RSQLite::SQLite(),"ecommerce.db")
```


## SQL Database Schema Creation

### ADS
```{sql connection = my_db}
CREATE TABLE ADS(
  AD_ID VARCHAR(30) PRIMARY KEY,
  PLATFORM VARCHAR(255),
  AD_TITLE VARCHAR(255),
  AD_TYPE VARCHAR(70),
  AD_START_DATE DATE,
  AD_END_DATE DATE,
  COST_PER_CLICK FLOAT,
  CLICK_THROUGH_RATE FLOAT,
  NUMBER_OF_CLICKS FLOAT
);
```

### PROMOTION
```{sql connection = my_db}
CREATE TABLE PROMOTION (
  PROMOTION_ID VARCHAR(30) PRIMARY KEY,
  PROMOTION_VALUE FLOAT,
  PROMOTION_START_DATE DATE,
  PROMOTION_END_DATE DATE,
  MINIMUM_PURCHASE_AMOUNT FLOAT
);
```


### CATEGORY
```{sql connection = my_db}
CREATE TABLE CATEGORY(
  CATEGORY_ID VARCHAR(30) PRIMARY KEY,
  CATEGORY_NAME TEXT NOT NULL,
  GENDER TEXT,
  AGE_GROUP VARCHAR(30)
);
```

### SUPPLIER
```{sql connection = my_db}
CREATE TABLE SUPPLIER (
    SUPPLER_ID VARCHAR(30) PRIMARY KEY,
    SUPPLIER_NAME VARCHAR(50),
    SUPPLIER_PHONE NUMERIC(10),
    SUPPLIER_POSTCODE VARCHAR(30),
    SUPPLIER_EMAIL VARCHAR(30)
);
```

### CUSTOMERS
```{sql connection=my_db}
CREATE TABLE IF NOT EXISTS CUSTOMERS(
  CUSTOMER_ID VARCHAR(30) PRIMARY KEY,
  AD_ID VARCHAR(30),
  EMAIL_ADDRESS VARCHAR(30),
  PHONE_NUMBER NUMERIC(10),
  CUSTOMER_NAME VARCHAR(30),
  CUSTOMER_GENDER TEXT,
  DATE_OF_BIRTH DATE,
  HOUSE_NUMBER VARCHAR(30),
  POSTCODE VARCHAR(30),
  FOREIGN KEY (AD_ID) REFERENCES ADS (AD_ID)
);
```

### PRODUCT
```{sql connection=my_db}
CREATE TABLE IF NOT EXISTS SKU(
    PRODUCT_ID VARCHAR(30) PRIMARY KEY,
    SUPPLIER_ID VARCHAR(30),
    CATEGORY_ID VARCHAR(30),
    COLOR TEXT,
    UNIT_WEIGHT FLOAT,
    PRODUCT_SELLING_PRICE FLOAT,
    PRODUCT_PURCHASING_PRICE FLOAT,
    BRAND TEXT,
    FOREIGN KEY (SUPPLIER_ID) REFERENCES SUPPLIER(SUPPLIER_ID),
    FOREIGN KEY (CATEGORY_ID) REFERENCES CATEGORY(CATEGORY_ID)
);
```

### TRANSACTION
```{sql connection=my_db}
CREATE TABLE TRANSACTIONS(
  TRANSACTION_ID VARCHAR(30) PRIMARY KEY,
  TRANSACTION_VALUE FLOAT,
  PAYMENT_METHOD VARCHAR(50),
  TRANSACTION_STATUS VARCHAR(50)
);
```


### ORDERS
```{sql connection=my_db}
CREATE TABLE ORDERS (
  ORDER_ID VARCHAR(30) PRIMARY KEY,
  PRODUCT_ID VARCHAR(30),
  CUSTOMER_ID VARCHAR(30),
  TRANSACTION_ID VARCHAR(30),
  ORDER_QUANTITY INTEGER,
  ORDER_DATE DATE,
  ORDER_STATUS TEXT,
  FOREIGN KEY (PRODUCT_ID) REFERENCES SKU(PRODUCT_ID),
  FOREIGN KEY (CUSTOMER_ID) REFERENCES CUSTOMERS(CUSTOMER_ID),
  FOREIGN KEY (TRANSACTION_ID) REFERENCES TRANSACTIONS(TRANSACTION_ID)
);
```


### RETURNS

```{sql connection=my_db}
CREATE TABLE RETURNS(
  RETURN_ID VARCHAR(30) PRIMARY KEY,
  PRODUCT_ID VARCHAR(30),
  CUSTOMER_ID VARCHAR(30),
  RETURN_QUANTITY NUMERIC,
  RETURN_DATE DATE,
  RETURN_STATUS TEXT,
  FOREIGN KEY (PRODUCT_ID) REFERENCES SKU(PRODUCT_ID),
  FOREIGN KEY (CUSTOMER_ID) REFERENCES CUSTOMERS(CUSTOMER_ID)
);
```







## Synthetic Data Generation

```{r}
# Define vectors for categories, genders, and age groups
CATEGORY_NAME <- c('Shirts', 'Inner_wear', 'Activewear', 'Shoes', 'Jackets', 'Gloves', 'Thermals', 'Pants', 'Jeans', 'Trousers', 'Formal_Wear', 'Casuals')
GENDER <- c("Male", "Female")
AGE_GROUP <- c('Kids', 'Pre-Teens', 'Young Adults', 'Adults')
CATEGORY_ID <- 10001:10096

# Generate all combinations
CATEGORY <- expand.grid(CATEGORY_NAME, GENDER, AGE_GROUP)
CATEGORY$CATEGORY_ID <- CATEGORY_ID

# Rename columns
names(CATEGORY) <- c("CATEGORY", "GENDER", "AGE_GROUP", "CATEGORY_ID")

# View the first few combinations
head(CATEGORY)
write.csv(CATEGORY,"Category.csv")
```


## Data Import and Quality Assurance

